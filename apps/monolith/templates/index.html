{% extends "layout.html" %}

{% block content %}
<div class="container">
    <!-- Toolbar -->
    <div class="toolbar">
        <button class="toolbar-btn">File</button>
        <button class="toolbar-btn">View</button>
        <button class="toolbar-btn">Window</button>
        <button class="toolbar-btn">Help</button>
    </div>

    <!-- Left Sidebar: Tools -->
    <div class="sidebar">
        <div class="sidebar-header">TOOLS</div>

        <div class="upload-section">
            <button id="uploadBtn">Load Image</button>
            <input type="file" id="fileInput" accept="image/*" style="display: none;">
        </div>

        {% for category in tools %}
        <div class="tool-category">
            <div class="category-header" data-category="{{ category.name }}">
                <span>{{ category.name }}</span>
                <span>▼</span>
            </div>
            <div class="tool-list" id="category-{{ category.name }}">
                {% for tool in category.tool_list %}
                <div class="tool-item" data-tool="{{ tool }}" data-category="{{ category.name }}">
                    {{ tool }}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Main Content: 2x2 Grid Layout -->
    <div class="main-content">
        <!-- Original Image Panel (Left side, full height) -->
        <div class="panel" id="originalImagePanel">
            <div class="panel-header">
                <div class="panel-title">Original Image</div>
                <div class="image-info">
                    <span id="imageName">No image loaded</span> |
                    <span id="imageDimensions">--</span>
                </div>
            </div>
            <div class="panel-content">
                <div id="emptyState" class="empty-state">
                    <i data-lucide="image-off"></i>
                    <p>No Image Loaded</p>
                    <p class="text-muted">Upload an image to begin forensic analysis</p>
                </div>

                <div id="imageViewer" class="hidden">
                    <div id="viewerCanvas">
                        <img id="mainImage" alt="Evidence Image">
                    </div>
                    <div class="viewer-controls">
                        <button id="zoomIn" title="Zoom In">+</button>
                        <button id="zoomOut" title="Zoom Out">−</button>
                        <button id="resetZoom" title="Reset">1:1</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hex Editor Panel (Top-right) -->
        <div class="panel" id="hexEditorPanel">
            <div class="panel-header">
                <div class="panel-title">Hex Editor</div>
            </div>
            <div class="panel-content">
                <pre id="hexContent" style="font-family: monospace; font-size: 11px; line-height: 1.3; margin: 0;">
<span class="text-muted">No file loaded</span></pre>
            </div>
        </div>

        <!-- File Digest Panel (Bottom-right) -->
        <div class="panel" id="fileDigestPanel">
            <div class="panel-header">
                <div class="panel-title">File Information</div>
            </div>
            <div class="panel-content">
                <div id="digestContent">
                    <p class="text-muted">Upload an image to view file information</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Tool Panel (Overlay - Hidden by default) -->
<div class="tool-panel" id="toolPanel">
    <div class="panel-header">
        <div class="panel-title" id="toolTitle">Analysis Results</div>
        <button id="closePanel">×</button>
    </div>
    <div class="panel-content" id="toolContent">
        <p class="text-muted">Select a tool from the left sidebar to begin analysis.</p>
    </div>
</div>

<!-- Toast Container -->
<div id="toastContainer"></div>

<!-- Initialize global state -->
<script>
    window.appState = {
        currentImagePath: null,
        currentImage: null,
        zoom: 1.0
    };
</script>
{% endblock %}